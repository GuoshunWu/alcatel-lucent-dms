<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>

    <style type="text/css">
        @import "//frcolv10lin237.pqa-collab.fr.alcatel-lucent.com/css/jqueryUI/themes/base/jquery.ui.all.css";
    </style>

    <style type="text/css">
        .preview {
            /*height: 100px;*/
            font-weight: bolder;
            font-size: 10px;
            text-align: center;
        }

        .playerFont {
            font-family: Lucida Grande, Lucida Sans, Arial, Helvetica, sans-serif, '宋体';
            font-size: 12px;
        }
    </style>
</head>
<body>
<table border="0" id="guidesArea">
    <thead>
    <tr>
        <th colspan="2">Guides</th>
    </tr>
    </thead>
    <tbody></tbody>
</table>

<div id="playerDialog" style="padding: 0px;">
    <table style="height: 100%; width: 100%" border="0">
        <tr>
            <td>
                <div class="playerContent"></div>
            </td>
        </tr>
    </table>
</div>


<script src="//frcolv10lin237.pqa-collab.fr.alcatel-lucent.com/js/lib/jquery-1.7.2.min.js" type="text/javascript">
</script>
<script src="//frcolv10lin237.pqa-collab.fr.alcatel-lucent.com/js/lib/jquery-ui-1.8.22.custom.min.js"
        type="text/javascript">
</script>


<script type="text/javascript">
    $(function () {

        var defaultPlayer = $("div#playerDialog").dialog({
            autoOpen: false, resizable: false,
            dialogClass: 'playerFont',
            width: 1133, height: "auto",
            close: function (event, ui) {
                $("div.playerContent", this).empty();
            }
        });

        function showTutorial(swf, title, player) {
            if (!player) player = defaultPlayer;
            var width = 1126, height = 667,
                    embed = '<' + 'EMBED ' + 'SRC="' + swf + '" width= ' + width + ' height=' + height + ' qulity=low loop=false wmode=transparent ';
            embed += "type='application/x-shockwave-flash' ";
            embed += 'pluginspage="http://www.macromedia.com/shockwave/download/index.cgi?P1_Prod_Version=ShockwaveFlash"' + '>';
            embed += "<" + '/EMBED' + '>';

            $("div.playerContent", player).html(embed);
            player.dialog("option", "title", title)
                    .dialog("open");
        }


        function initPreviews(container, colNum, swfFiles) {
            if (!container) container = $("#guidesArea");
            if (!colNum) colNum = 2;
            var remoteResourceAddr = "//frcolv10lin237.pqa-collab.fr.alcatel-lucent.com/",
                    swfBasePath = remoteResourceAddr + "manual/",
                    imageBasePath = remoteResourceAddr + "images/",
                    rowNum = Math.ceil(swfFiles.length / colNum),
                    swfIndex = 0,
                    imgFileName = "play_icon.png";

            for (var row = 0; row < rowNum; ++row) {
                //create tr
                var trRow = $("<" + "tr" + ">");
                for (var col = 0; col < colNum; ++col) {
                    if (swfIndex >= swfFiles.length)break;
                    var fileEntry = swfFiles[swfIndex++];

                    var preview = $("<" + "div" + ">").addClass("preview").prop("id", swfBasePath + fileEntry.filename + ".swf").append(
                            $("<" + "img" + ">").prop("src", imageBasePath + imgFileName).after("<" + "br/" + ">" + fileEntry.title));

                    preview.on("mouseover", function (e) {
                        $(this).addClass('ui-state-hover');
                    })
                            .on("mouseout", function (e) {
                                $(this).removeClass('ui-state-hover');
                            })
                            .on("click", function (e) {
                                var swfURL = this.id;
                                if (!swfURL) return;
                                var title = $.trim($(this).text());
                                if (typeof console !== "undefined" && console !== null) {
                                    console.log("swfURL=" + swfURL + ", title=" + title);
                                }
                                showTutorial(swfURL, title);
                            });
                    trRow.append($("<" + "td" + ">").append(preview));
                }
                $("tbody", container).append(trRow);
            }
        }

        var jsonServerBase = "//frcolv10lin237.pqa-collab.fr.alcatel-lucent.com/";
        jsonServerBase = '../';

        var test = $.getJSON(jsonServerBase + "scripts/tutorialsJSON.groovy", function (json) {
            initPreviews($("#guidesArea"), 2, json);
        });

    });
</script>
</body>
</html>