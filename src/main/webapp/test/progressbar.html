<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Load...</title>
    <script src="../js/lib/jquery-1.7.2.min.js"></script>
    <script>
        jQuery(function ($) {
            var url = '../scripts/cp.groovy';

            function long_polling(cmd) {
                $.getJSON(url, {cmd: cmd}).done(function (data, textStatus, jqXHR) {
                    if (console) {
                        console.log(data);
                    }
                    $('#logs').append(data.msg + "<br/>");
                    if (/^done/.test(data.msg)) return;

                    setTimeout(function () {
                        long_polling('process')
                    }, 500);

//                    long_polling('process');
                });
            }

            long_polling('start');

        });
    </script>
</head>
<body>
<h2 align="center">Load...</h2>

<div id="logs" style="font-family: monospace;"/>
A simple test.
</body>
</html>