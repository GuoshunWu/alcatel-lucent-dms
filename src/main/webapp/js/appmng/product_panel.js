// Generated by CoffeeScript 1.3.3
(function() {

  define(['jquery', 'appmng/application_grid'], function($, grid) {
    var URL, localIds;
    URL = {
      get_product_by_base_id: 'rest/products/'
    };
    localIds = {
      select_product_version: '#selVersion',
      new_product_version: '#newVersion',
      disp_product_name: '#dispProductName'
    };
    $(localIds.new_product_version).button({
      text: false,
      icons: {
        primary: "ui-icon-plus"
      }
    }).click(function() {
      return $("#" + ids.dialog.new_product_release).dialog("open");
    });
    $(localIds.select_product_version).change(function() {
      var product;
      product = {
        version: $(this).find("option:selected").text(),
        id: $(this).val()
      };
      return grid.productChanged(product);
    });
    return {
      refresh: function(info) {
        $(localIds.disp_product_name).html(info.text);
        return $.getJSON(URL.get_product_by_base_id + info.id, {}, function(json) {
          $(localIds.select_product_version).empty().append($(json).map(function() {
            return new Option(this.version, this.id);
          }));
          return $(localIds.select_product_version).trigger('change');
        });
      },
      getSelectedProduct: function() {
        return {
          version: $(localIds.select_product_version).find("option:selected").text(),
          id: $(localIds.select_product_version).val()
        };
      }
    };
  });

}).call(this);
