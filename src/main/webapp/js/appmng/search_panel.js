// Generated by CoffeeScript 1.6.2
(function() {
  define(['jqueryui', 'i18n!nls/appmng', 'i18n!nls/common', 'dms-util', 'dms-urls', 'appmng/layout', 'appmng/global_search_grid'], function($, i18n, c18n, util, urls, layout, sgrid) {
    var globalSearchInResultPanel, globalSearchInResultPanelDistinct, searchActionBtn, searchResultActionBtn, searchText;

    searchText = function(text, fuzzy) {
      var grid, postData;

      if (fuzzy == null) {
        fuzzy = false;
      }
      grid = $('#globalSearchResultGrid');
      postData = grid.getGridParam('postData');
      postData.format = 'grid';
      postData.text = text;
      postData.fuzzy = fuzzy;
      postData.prop = 'dictionary.base.applicationBase.productBase.name, dictionary.base.applicationBase.name, dictionary.nameVersion, key,reference,maxLength,context.name,t,n,i';
      delete postData.app;
      delete postData.prod;
      if (typeof console !== "undefined" && console !== null) {
        console.log(postData);
      }
      return grid.setGridParam({
        url: (fuzzy ? urls.labels : urls.labels_normal),
        page: 1
      }).trigger('reloadGrid');
    };
    searchResultActionBtn = $('#globalSearchInResultPanelAction', '#appmng').attr('title', 'Search').button({
      text: false,
      icons: {
        primary: "ui-icon-search"
      }
    }).height(20).width(20).position({
      my: 'left center',
      at: 'right center',
      of: '#globalSearchInResultPanel'
    });
    globalSearchInResultPanelDistinct = $('#globalSearchInResultPanel_fuzzy');
    searchResultActionBtn.click(function() {
      return searchText($('#globalSearchInResultPanel', '#appmng').val(), Boolean(globalSearchInResultPanelDistinct.attr('checked')));
    });
    globalSearchInResultPanel = $('#globalSearchInResultPanel', '#appmng').keydown(function(e) {
      if (e.which !== 13) {
        return true;
      }
      searchResultActionBtn.trigger('click');
      return false;
    });
    searchActionBtn = $('#globalSearchAction', '#appmng').attr('title', 'Search').button({
      text: false,
      icons: {
        primary: "ui-icon-search"
      }
    }).height(20).width(20).position({
      my: 'left center',
      at: 'right center',
      of: '#globalSearch'
    }).click(function() {
      var fuzzy, searchValue;

      searchValue = $('#globalSearch', '#appmng').val();
      fuzzy = Boolean($('#globalSearch_fuzzy').attr('checked'));
      globalSearchInResultPanel.val(searchValue);
      globalSearchInResultPanelDistinct.attr('checked', fuzzy);
      layout.showSearchPanel();
      return searchText(searchValue, fuzzy);
    });
    $('#globalSearch', '#appmng').keydown(function(e) {
      if (e.which !== 13) {
        return true;
      }
      searchActionBtn.trigger('click');
      return false;
    });
    $('#goBackToWelcome').button().click(function() {
      return layout.showWelcomePanel();
    });
    return $('#groupingToggle').button().click(function() {
      var grid;

      grid = $('#globalSearchResultGrid');
      return $("[id^='globalSearchResultGridghead_2_']").each(function(index, elem) {
        grid.groupingToggle(elem.id);
        return true;
      });
    });
  });

}).call(this);
